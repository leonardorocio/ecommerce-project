<div
  class="container-fluid d-flex justify-content-center flex-column border rounded my-3 p-3"
>
  <p class="lead fw-bold">Descrição:</p>
  <p class="lead">{{ method.description }}</p>

  <form
    #requestForm="ngForm"
    id="requestForm"
    (ngSubmit)="submitForm(method.operationId, requestForm)"
    class="form-group"
  >
    <ng-container *ngIf="hasParameters">
      <p class="lead fw-bold">Parâmetros</p>
      <ng-container *ngFor="let parameter of method.parameters">
        <ng-container
          *ngIf="parameter.schema.type === 'integer'; else stringParameterInput"
        >
          <label [for]="parameter.name" class="form-label">{{
            parameter.name | camelCase
          }}</label>
          <input
            class="form-control"
            type="number"
            ngModel
            [name]="'param_' + parameter.name"
            [id]="'param_' + parameter.name"
          />
        </ng-container>
        <ng-template #stringParameterInput>
          <label [for]="parameter.name" class="form-label">{{
            parameter.name | camelCase
          }}</label>
          <input
            class="form-control"
            ngModel
            type="text"
            [name]="'param_' + parameter.name"
            [id]="'param_' + parameter.name"
          />
        </ng-template>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="hasRequestBody">
      <p class="lead fw-bold">Corpo da requisição</p>
      <ng-container
        *ngFor="let field of requestBody.properties | keyvalue; let i = index"
      >
        <ng-container *ngIf="field.value.$ref">
          <div class="mt-3">
            <label [for]="field.key" class="form-label">{{
              field.key | camelCase
            }}</label>
            <select
              [id]="field.key"
              class="form-select form-select-md"
              [name]="field.key"
              ngModel
              required
            >
            <!-- Uso ref.id porque é de certeza que na api o atributo de identificação é id pra todas as entidades -->
              <option *ngFor="let ref of getRef(field.key)" [ngValue]="ref.id">
                {{ ref.name ?? ref.id }}
              </option>
            </select>
          </div>
        </ng-container>
        <ng-container
          *ngIf="
            field.value.type === 'integer' || field.value.type === 'number'
          "
        >
          <div class="mt-3">
            <label [for]="field.key" class="form-label">{{
              field.key | camelCase
            }}</label>
            <input
              type="number"
              [name]="field.key"
              [id]="field.key"
              class="form-control"
              [placeholder]="field.value.example"
              ngModel
            />
          </div>
        </ng-container>
        <ng-container *ngIf="field.value.type === 'string'">
          <div class="mt-3">
            <label [for]="field.key" class="form-label">{{
              field.key | camelCase
            }}</label>
            <input
              class="form-control"
              type="text"
              ngModel
              [name]="field.key"
              [id]="field.key"
            />
          </div>
        </ng-container>
      </ng-container>
    </ng-container>
    <button class="btn btn-primary w-25 mt-3" type="submit" form="requestForm">
      Enviar
    </button>
  </form>
  <div class="container-fluid d-flex flex-column mt-5">
    <app-admin-request-response
      [operationReturnData$]="operationReturnData$"
    ></app-admin-request-response>
  </div>
</div>
